<?xml version="1.0"?>
<!DOCTYPE module PUBLIC
        "-//Checkstyle//DTD Checkstyle Configuration 1.3//EN"
        "https://checkstyle.org/dtds/configuration_1_3.dtd">

<!--
    Checkstyle Minimal Configuration для DVT-7

    Курс: "Java с нуля до оффера"
    Спринт: Sprint 3 Dev Tools
    Аудитория: Новички без опыта программирования

    Стратегия:
    - 12 critical checks (error) → fail build
    - 15 pedagogical checks (warning) → показываем, не блокируем
    - Javadoc/Advanced checks (ignore) → отложено до Sprint 5+

    Gradle config:
    checkstyle {
        toolVersion = '10.12.4'
        maxErrors = 0        // Fail на первом error
        maxWarnings = 999    // Warnings не fail
    }
-->

<module name="Checker">

    <!-- ========== GLOBAL PROPERTIES ========== -->

    <property name="charset" value="UTF-8"/>
    <property name="severity" value="warning"/> <!-- Default severity для всех checks -->
    <property name="fileExtensions" value="java"/>

    <!-- Exclude module-info.java (не используется в учебном проекте) -->
    <module name="BeforeExecutionExclusionFileFilter">
        <property name="fileNamePattern" value="module\-info\.java$"/>
    </module>

    <!-- ========== FILE-LEVEL CHECKS ========== -->

    <!--
        CRITICAL: No tabs allowed (только spaces для индентации)

        Почему error:
        - Tabs vs Spaces = классическая проблема форматирования
        - Разный рендеринг в разных редакторах
        - Google Style требует только spaces

        Пример нарушения:
        →→public void method() {  // ❌ tab символ
            return;
        }

        Правильно:
          public void method() {  // ✅ 2 spaces
            return;
          }
    -->
    <module name="FileTabCharacter">
        <property name="severity" value="error"/>
        <property name="eachLine" value="true"/>
    </module>

    <!--
        WARNING: Line length limit (не fail build в Sprint 3)

        Почему warning:
        - Новички не знают line wrapping
        - 101 символ не критичная ошибка для обучения
        - Показываем проблему, но не блокируем прогресс

        Upgrade path: error в Sprint 5+ (Backend Core)
    -->
    <module name="LineLength">
        <property name="severity" value="warning"/>
        <property name="max" value="100"/>
        <property name="ignorePattern" value="^package.*|^import.*|a href|href|http://|https://|ftp://"/>
    </module>

    <!-- ========== TREE WALKER (код внутри Java файлов) ========== -->

    <module name="TreeWalker">

        <!-- ==================== NAMING CONVENTIONS ==================== -->
        <!--
            Приоритет 1: Naming conventions - фундамент читаемого Java кода

            Java соглашения:
            - Packages: lowercase (com.example.mcrm)
            - Classes: PascalCase (UserService, CustomerRepository)
            - Methods: camelCase (getUserById, calculateTotal)
            - Fields: camelCase (userName, customerAge)
            - Variables: camelCase (orderCount, totalPrice)
            - Constants: SCREAMING_SNAKE_CASE (MAX_SIZE, DEFAULT_TIMEOUT)

            Все naming checks = ERROR (основа урока DVT-7)
        -->

        <!-- Package names: lowercase only -->
        <module name="PackageName">
            <property name="severity" value="error"/>
            <property name="format" value="^[a-z]+(\.[a-z][a-z0-9]*)*$"/>
            <message key="name.invalidPattern"
                     value="Package name ''{0}'' must be lowercase (e.g., com.example, not Com.Example)"/>
        </module>

        <!-- Class/Interface names: PascalCase -->
        <module name="TypeName">
            <property name="severity" value="error"/>
            <property name="format" value="^[A-Z][a-zA-Z0-9]*$"/>
            <message key="name.invalidPattern"
                     value="Class name ''{0}'' must be PascalCase (e.g., UserService, not user_service or userService)"/>
        </module>

        <!-- Method names: camelCase -->
        <module name="MethodName">
            <property name="severity" value="error"/>
            <property name="format" value="^[a-z][a-zA-Z0-9]*$"/>
            <message key="name.invalidPattern"
                     value="Method name ''{0}'' must be camelCase starting with lowercase (e.g., getUserName, not get_user_name or GetUserName)"/>
        </module>

        <!--
            Field names: camelCase (NO snake_case!)

            Это основное задание DVT-7: студенты специально создают user_name
            и видят fail build, затем исправляют на userName
        -->
        <module name="MemberName">
            <property name="severity" value="error"/>
            <property name="format" value="^[a-z][a-zA-Z0-9]*$"/>
            <message key="name.invalidPattern"
                     value="Field name ''{0}'' must be camelCase (e.g., userName, not user_name or UserName)"/>
        </module>

        <!-- Local variable names: camelCase -->
        <module name="LocalVariableName">
            <property name="severity" value="error"/>
            <property name="format" value="^[a-z][a-zA-Z0-9]*$"/>
            <message key="name.invalidPattern"
                     value="Variable name ''{0}'' must be camelCase (e.g., customerAge, not customer_age)"/>
        </module>

        <!-- Parameter names: camelCase -->
        <module name="ParameterName">
            <property name="severity" value="error"/>
            <property name="format" value="^[a-z][a-zA-Z0-9]*$"/>
            <message key="name.invalidPattern"
                     value="Parameter name ''{0}'' must be camelCase (e.g., userId, not user_id)"/>
        </module>

        <!--
            Constant names: SCREAMING_SNAKE_CASE

            Только для static final полей (true constants)
        -->
        <module name="ConstantName">
            <property name="severity" value="error"/>
            <property name="format" value="^[A-Z][A-Z0-9]*(_[A-Z0-9]+)*$"/>
            <message key="name.invalidPattern"
                     value="Constant name ''{0}'' must be SCREAMING_SNAKE_CASE (e.g., MAX_SIZE, not maxSize or max_size)"/>
        </module>

        <!-- ==================== IMPORTS ==================== -->

        <!--
            CRITICAL: No wildcard imports

            Почему error:
            - import java.util.* скрывает зависимости
            - Explicit imports улучшают читаемость
            - Google Style запрещает wildcards

            Плохо:
            import java.util.*;  // ❌

            Хорошо:
            import java.util.List;     // ✅
            import java.util.ArrayList; // ✅
        -->
        <module name="AvoidStarImport">
            <property name="severity" value="error"/>
        </module>

        <!--
            WARNING: Import order (not critical для новичков)

            Порядок:
            1. Static imports
            2. Standard Java (java.*, javax.*)
            3. Third-party (org.*, com.*)

            Upgrade path: error в Sprint 7+ (Enterprise standards)
        -->


        <!-- WARNING: Unused imports (IDE обычно помечает автоматически) -->
        <module name="UnusedImports">
            <property name="severity" value="warning"/>
        </module>

        <!-- ==================== CODE STRUCTURE ==================== -->

        <!--
            CRITICAL: One top-level class per file

            Почему error:
            - Основное правило организации кода в Java
            - Поиск класса по имени файла
        -->
        <module name="OneTopLevelClass">
            <property name="severity" value="error"/>
        </module>

        <!--
            CRITICAL: Filename matches outer class name

            Почему error:
            - UserService.java должен содержать class UserService
            - Java compilation requirement
        -->
        <module name="OuterTypeFilename">
            <property name="severity" value="error"/>
        </module>

        <!--
            CRITICAL: One statement per line

            Почему error:
            - int x = 1; int y = 2; // ❌ hard to read

            Правильно:
            int x = 1;  // ✅
            int y = 2;  // ✅
        -->
        <module name="OneStatementPerLine">
            <property name="severity" value="error"/>
        </module>

        <module name="NeedBraces">
            <property name="severity" value="error"/>
            <property name="allowSingleLineStatement" value="false"/>
        </module>

        <!-- ==================== INDENTATION ==================== -->

        <!--
            CRITICAL: 2-space indentation (Google Style)

            Почему error:
            - Консистентный indent критичен для читаемости
            - 2 spaces (не 4, не tabs)

            Настройки:
            - basicOffset: 2 (основной indent)
            - caseIndent: 2 (switch cases)
            - lineWrappingIndentation: 4 (продолжение длинной строки)
        -->
        <module name="Indentation">
            <property name="severity" value="error"/>
            <property name="basicOffset" value="2"/>
            <property name="braceAdjustment" value="0"/>
            <property name="caseIndent" value="2"/>
            <property name="throwsIndent" value="4"/>
            <property name="lineWrappingIndentation" value="4"/>
            <property name="arrayInitIndent" value="2"/>
        </module>

        <!-- ==================== WHITESPACE ==================== -->
        <!--
            WARNING severity: показываем проблемы, но не блокируем

            Upgrade path: error в Sprint 5+ (professional formatting)
        -->

        <!-- ==================== MISCELLANEOUS ==================== -->

        <!--
            CRITICAL: Java-style array declarations

            Почему error:
            - String [] args // ❌ C-style
            - String[] args  // ✅ Java-style
        -->
        <module name="ArrayTypeStyle">
            <property name="severity" value="error"/>
        </module>

    </module>
</module>